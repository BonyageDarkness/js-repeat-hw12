{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport default async function getImagesByQuery(query, page) {\n  const API_KEY = '44822574-4b43621c9303530917b2f490d';\n  const params = new URLSearchParams({\n    per_page: 15,\n    page: page,\n  });\n  const response = await axios.get(\n    `https://pixabay.com/api/?key=${API_KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&${params}`\n  );\n  return response.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryBox = new SimpleLightbox('.gallery a');\nfunction showLoader() {\n  document.getElementById('loader').classList.add('is-visible');\n}\nfunction hideLoader() {\n  document.getElementById('loader').classList.remove('is-visible');\n}\n\nfunction createGallery(images) {\n  const gallery = document.querySelector('.gallery');\n  const galleryItems = images\n    .map(image => {\n      return `\n    <li class=\"gallery-item\" style=\"list-style-type: none;\">\n      <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\"\n            style=\"width: 360px; height: 200px; flex-shrink: 0; font-size: 0;\" />\n      </a>\n      <div class=\"description\">\n      <p class=\"likes\"><strong>Likes</strong>${image.likes}</p>\n      <p class=\"views\"><strong>Views</strong>${image.views}</p>\n      <p class=\"comments\"><strong>Comments</strong>${image.comments}</p>\n      <p class=\"downloads\"><strong>Downloads</strong>${image.downloads}</p>\n      </div>\n\n    </li>\n  `;\n    })\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', galleryItems);\n\n  galleryBox.refresh();\n  hideLoader();\n}\n\nexport default createGallery;\n","import getImagesByQuery from './js/pixabay-api';\n\nimport createGallery from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form');\nconst loadBtn = document.querySelector('.loadBtn');\n\nlet page = 1;\nlet lastQuery = '';\nlet totalHits = 0;\nconst perPage = 15;\n\nloadBtn.style.display = 'none';\n\nform.addEventListener('submit', imageSearch);\n\nfunction imageSearch(e) {\n  e.preventDefault();\n  const input = e.currentTarget;\n  const queryValue = input.elements['search-text'].value.toLowerCase();\n\n  if (queryValue !== lastQuery) {\n    page = 1;\n    document.querySelector('.gallery').innerHTML = '';\n  }\n  lastQuery = queryValue;\n\n  getImagesByQuery(queryValue, page)\n    .then(data => {\n      if (data.hits.length === 0) {\n        loadBtn.style.display = 'none';\n        return iziToast.error({\n          message: `Sorry, there are no images matching your ${queryValue}. Please try again!`,\n        });\n      }\n\n      createGallery(data.hits);\n      totalHits = data.totalHits;\n      updateLoadBtnVisibility();\n    })\n    .catch(err => console.log('error catch', err));\n\n  form.reset();\n}\n\nloadBtn.addEventListener('click', async () => {\n  const data = await getImagesByQuery(lastQuery, page + 1);\n  if (data.hits.length === 0) {\n    loadBtn.style.display = 'none';\n    return iziToast.error({\n      position: 'topRight',\n      message: \"We're sorry, there are no more posts to load\",\n    });\n  }\n  page += 1;\n  createGallery(data.hits);\n  totalHits = data.totalHits;\n  updateLoadBtnVisibility();\n  const allItems = document.querySelectorAll('.gallery-item');\n  const firstNewIndex = (page - 1) * perPage;\n  const firstNewItem = allItems[firstNewIndex];\n  if (firstNewItem) {\n    firstNewItem.scrollIntoView({ behavior: 'smooth', block: 'start' });\n  }\n});\n\nfunction updateLoadBtnVisibility() {\n  if (page * perPage >= totalHits || totalHits <= perPage) {\n    loadBtn.style.display = 'none';\n    iziToast.success({\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    loadBtn.style.display = 'block';\n  }\n}\n"],"names":["getImagesByQuery","query","page","API_KEY","params","axios","galleryBox","SimpleLightbox","hideLoader","createGallery","images","gallery","galleryItems","image","form","loadBtn","lastQuery","totalHits","perPage","imageSearch","e","queryValue","data","iziToast","updateLoadBtnVisibility","err","allItems","firstNewIndex","firstNewItem"],"mappings":"owBAEe,eAAeA,EAAiBC,EAAOC,EAAM,CAC1D,MAAMC,EAAU,qCACVC,EAAS,IAAI,gBAAgB,CACjC,SAAU,GACV,KAAMF,CACV,CAAG,EAID,OAHiB,MAAMG,EAAM,IAC3B,gCAAgCF,CAAO,MAAMF,CAAK,4DAA4DG,CAAM,EACxH,GACkB,IAClB,CCTA,MAAME,EAAa,IAAIC,EAAe,YAAY,EAIlD,SAASC,GAAa,CACpB,SAAS,eAAe,QAAQ,EAAE,UAAU,OAAO,YAAY,CACjE,CAEA,SAASC,EAAcC,EAAQ,CAC7B,MAAMC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAeF,EAClB,IAAIG,GACI;AAAA;AAAA,sCAEyBA,EAAM,aAAa;AAAA,0CACfA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA,+CAIjCA,EAAM,KAAK;AAAA,+CACXA,EAAM,KAAK;AAAA,qDACLA,EAAM,QAAQ;AAAA,uDACZA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA,GAKjE,EACA,KAAK,EAAE,EAEVF,EAAQ,mBAAmB,YAAaC,CAAY,EAEpDN,EAAW,QAAO,EAClBE,EAAU,CACZ,CC/BA,MAAMM,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAEjD,IAAIb,EAAO,EACPc,EAAY,GACZC,EAAY,EAChB,MAAMC,EAAU,GAEhBH,EAAQ,MAAM,QAAU,OAExBD,EAAK,iBAAiB,SAAUK,CAAW,EAE3C,SAASA,EAAYC,EAAG,CACtBA,EAAE,eAAc,EAEhB,MAAMC,EADQD,EAAE,cACS,SAAS,aAAa,EAAE,MAAM,YAAW,EAE9DC,IAAeL,IACjBd,EAAO,EACP,SAAS,cAAc,UAAU,EAAE,UAAY,IAEjDc,EAAYK,EAEZrB,EAAiBqB,EAAYnB,CAAI,EAC9B,KAAKoB,GAAQ,CACZ,GAAIA,EAAK,KAAK,SAAW,EACvB,OAAAP,EAAQ,MAAM,QAAU,OACjBQ,EAAS,MAAM,CACpB,QAAS,4CAA4CF,CAAU,qBACzE,CAAS,EAGHZ,EAAca,EAAK,IAAI,EACvBL,EAAYK,EAAK,UACjBE,EAAuB,CACzB,CAAC,EACA,MAAMC,GAAO,QAAQ,IAAI,cAAeA,CAAG,CAAC,EAE/CX,EAAK,MAAK,CACZ,CAEAC,EAAQ,iBAAiB,QAAS,SAAY,CAC5C,MAAMO,EAAO,MAAMtB,EAAiBgB,EAAWd,EAAO,CAAC,EACvD,GAAIoB,EAAK,KAAK,SAAW,EACvB,OAAAP,EAAQ,MAAM,QAAU,OACjBQ,EAAS,MAAM,CACpB,SAAU,WACV,QAAS,8CACf,CAAK,EAEHrB,GAAQ,EACRO,EAAca,EAAK,IAAI,EACvBL,EAAYK,EAAK,UACjBE,EAAuB,EACvB,MAAME,EAAW,SAAS,iBAAiB,eAAe,EACpDC,GAAiBzB,EAAO,GAAKgB,EAC7BU,EAAeF,EAASC,CAAa,EACvCC,GACFA,EAAa,eAAe,CAAE,SAAU,SAAU,MAAO,QAAS,CAEtE,CAAC,EAED,SAASJ,GAA0B,CAC7BtB,EAAOgB,GAAWD,GAAaA,GAAaC,GAC9CH,EAAQ,MAAM,QAAU,OACxBQ,EAAS,QAAQ,CACf,QAAS,4DACf,CAAK,GAEDR,EAAQ,MAAM,QAAU,OAE5B"}